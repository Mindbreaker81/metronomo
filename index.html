<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metrónomo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body class="dark-theme">
    <button class="theme-toggle" id="theme-toggle" title="Cambiar tema">
        <i class="fas fa-sun"></i>
    </button>

    <div class="container">
        <h1>Metrónomo</h1>

        <!-- Beat Counter -->
        <div class="measure-counter">
            <span class="measure-label">Compás</span>
            <span class="measure-number" id="measure-number">1</span>
        </div>

        <div class="bpm-display">
            <span id="bpm-value">120</span>
            <span class="bpm-label">BPM</span>
        </div>

        <div class="beat-indicator">
            <div class="beat-dot" id="beat-dot"></div>
        </div>

        <div class="controls">
            <input
                type="range"
                id="bpm-slider"
                min="40"
                max="220"
                value="120"
            >
            <div class="bpm-range">
                <span>40</span>
                <span>220</span>
            </div>
        </div>

        <div class="input-group">
            <input
                type="number"
                id="bpm-input"
                min="40"
                max="220"
                value="120"
            >
            <span>BPM</span>
        </div>

        <!-- Tap Tempo -->
        <button class="tap-tempo-btn" id="tap-tempo-btn">
            <i class="fas fa-hand-pointer"></i>
            <span>Tap Tempo</span>
        </button>

        <!-- Sound Selector -->
        <div class="sound-selector">
            <label for="sound-select">Sonido:</label>
            <select id="sound-select">
                <option value="click">Click</option>
                <option value="beep">Beep</option>
                <option value="woodblock">Woodblock</option>
                <option value="digital">Digital</option>
            </select>
        </div>

        <!-- Toggles -->
        <div class="toggles-row">
            <div class="toggle-item">
                <span class="toggle-label"><i class="fas fa-mobile-vibrate"></i> Vibrar</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="vibration-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="toggle-item">
                <span class="toggle-label"><i class="fas fa-bolt"></i> Flash</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="flash-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>

        <!-- BPM Presets -->
        <div class="presets-section">
            <span class="presets-label">Guardados:</span>
            <div class="presets-list" id="presets-list">
                <span class="no-presets">Sin presets</span>
            </div>
            <button class="save-preset-btn" id="save-preset-btn" title="Guardar BPM actual">
                <i class="fas fa-plus"></i> Guardar
            </button>
        </div>

        <!-- Advanced Mode Toggle -->
        <div class="advanced-toggle-section">
            <div class="toggle-item">
                <span class="toggle-label"><i class="fas fa-sliders-h"></i> Modo Avanzado</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="advanced-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>

        <!-- Advanced Options Panel -->
        <div class="advanced-panel collapsed" id="advanced-panel">
            <div class="advanced-section">
                <h4><i class="fas fa-clock"></i> Compás (Time Signature)</h4>
                <div class="time-signature-selector">
                    <button class="ts-btn active" data-ts="4">4/4</button>
                    <button class="ts-btn" data-ts="3">3/4</button>
                    <button class="ts-btn" data-ts="2">2/4</button>
                    <button class="ts-btn" data-ts="6">6/8</button>
                </div>
            </div>

            <div class="advanced-section">
                <h4><i class="fas fa-cut"></i> Subdivisiones</h4>
                <div class="subdivision-selector">
                    <button class="sub-btn active" data-sub="1">Ninguna</button>
                    <button class="sub-btn" data-sub="2">Corcheas</button>
                    <button class="sub-btn" data-sub="3">Tercinas</button>
                    <button class="sub-btn" data-sub="4">Semicorcheas</button>
                </div>
            </div>

            <div class="advanced-section">
                <h4><i class="fas fa-hand-pointer"></i> Tap Tempo Mejorado</h4>
                <div class="tap-tempo-display" id="tap-tempo-display">
                    <div class="tap-history" id="tap-history">
                        <span class="tap-placeholder">Pulsa al ritmo...</span>
                    </div>
                    <div class="tap-info">
                        <span class="tap-avg-label">Promedio:</span>
                        <span class="tap-avg-value" id="tap-avg-value">--</span>
                        <span class="tap-stability" id="tap-stability"></span>
                    </div>
                    <button class="tap-reset-btn" id="tap-reset-btn" title="Resetear taps">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
            </div>
        </div>

        <button id="play-btn" class="play-btn">
            <span id="btn-icon">▶</span>
            <span id="btn-text">Iniciar</span>
        </button>

        <div class="instructions">
            <button class="instructions-toggle" id="instructions-toggle">
                <span>Cómo usar</span>
                <span class="arrow" id="instructions-arrow">▼</span>
            </button>
            <div class="instructions-content collapsed" id="instructions-content">
                <ul>
                    <li>Ajusta los BPM usando el deslizador o introduce un valor (40-220)</li>
                    <li>Pulsa <strong>Iniciar</strong> o la barra espaciadora para comenzar</li>
                    <li>Usa <strong>Tap Tempo</strong> para marcar el ritmo manualmente</li>
                    <li>Guarda tus BPMs frecuentes con el botón <strong>Guardar</strong></li>
                    <li>Activa <strong>Vibrar</strong> para feedback táctil en móviles</li>
                    <li>Activa <strong>Flash</strong> para que la pantalla parpadee con cada beat</li>
                    <li>Activa <strong>Modo Avanzado</strong> para compás, subdivisiones y tap mejorado</li>
                </ul>

                <div class="advanced-features-list">
                    <p class="advanced-features-title">Modo Avanzado incluye:</p>
                    <ul>
                        <li><strong>Compás:</strong> 4/4, 3/4, 2/4, 6/8 con acento en el primer beat</li>
                        <li><strong>Subdivisiones:</strong> Corcheas, tercinas, semicorcheas</li>
                        <li><strong>Tap Mejorado:</strong> Historial, promedio y estabilidad</li>
                    </ul>
                </div>

                <div class="device-notices">
                    <div class="notice mobile">
                        <strong>Móvil (iPhone):</strong> Desactiva el interruptor de silencio para escuchar el clic
                    </div>
                    <div class="notice tablet">
                        <strong>Tablet (iPad/Android):</strong> Asegúrate de que el volumen esté activado
                    </div>
                    <div class="notice desktop">
                        <strong>Ordenador:</strong> Verifica que el audio de tu sistema no esté silenciado
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 | <a href="https://github.com/Mindbreaker81/metronomo" target="_blank">Mindbreaker81</a></p>
    </footer>

    <script src="app.js"></script>
</body>
</html>
